angular.module("search",["core"]).config(["iocMapProvider",function(t){t.map({moviesGateway:"httpMoviesGateway"})}]).constant("SEARCHURL","app/modules/search/"),angular.module("search").constant("API_KEY","nd3uzzypjhqxjqhujpqukdsu").constant("SEARCH_ENDPOINT","http://api.rottentomatoes.com/api/public/v1.0/movies.json").factory("httpMoviesGateway",["$http","API_KEY","SEARCH_ENDPOINT",function(t,e,n){return{search:function(a,o){return t.jsonp(n,{params:_.defaults({},o||{},{q:a,apikey:e,callback:"JSON_CALLBACK"})})}}}]),angular.module("search").factory("PaginatedMovies",["BaseCollection",function(t){var e=t.extend({total:0,pagination:{},setPagination:function(t){this.resetPagination(),angular.extend(this.pagination,t)},resetPagination:function(){for(var t in this.pagination)delete this.pagination[t]}});return new e}]),angular.module("search").directive("searchForm",["formBuilder","SEARCHURL",function(t,e){return t({templateUrl:e+"components/form.tmpl.html",formName:"searchForm"})}]),angular.module("search").value("paginationDefaults",{page_limit:10}).factory("searchMovies",["PaginatedMovies","paginationDefaults","moviesGateway",function(t,e,n){return function(a,o){return o=_.extend(o||{},e),n.search(a,o).then(function(e){t.set(e.data.movies),t.total=e.data.total,t.setPagination(_.extend({total:e.data.total},o))})}}]),angular.module("login",["ngStorage","core"]).constant("LOGINURL","app/modules/login/"),angular.module("login").directive("signinForm",["formBuilder","LOGINURL",function(t,e){return t({templateUrl:e+"components/form.tmpl.html",formName:"signinForm"})}]),angular.module("login").factory("login",["User","userGateway",function(t,e){return function(n){return e.validCredentials(n).then(function(){user={username:n.username,isAdmin:!0},e.saveToClient(user),t.set(user)})}}]),angular.module("routes",["core","modules","ui.router"]).constant("ROUTESURL","app/routes/").constant("URLMAP",{home:"/",search:"search"}).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("root",{"abstract":!0,template:"<ui-view></ui-view>"}),e.otherwise("/")}]).factory("globalResolve",["$q","fetchUserFromClient",function(t,e){return t.all([e()])}]).run(["globalResolve","$rootScope","User","$state",function(t,e,n,a){e.$on("$stateChangeStart",function(o,r,i,s,l){return r.publicRoute?!0:(o.preventDefault(),void t.then(function(){1!=n.get("isAdmin")?a.transitionTo("root.signin"):a.transitionTo(r.name,i,{notify:!1}).then(function(){e.$broadcast("$stateChangeSuccess",r,i,s,l)})}))})}]),angular.module("routes").config(["$stateProvider","URLMAP","ROUTESURL",function(t,e,n){t.state("root.signin",{url:e.signin,templateUrl:n+"signin/signin.tmpl.html",controller:"SigninCtrl",controllerAs:"signin",publicRoute:!0})}]).controller("SigninCtrl",["login",function(t){var e=this;e.user={},e.submitLogin=function(){return t(e.user)}}]),angular.module("routes").config(["$stateProvider","URLMAP","ROUTESURL",function(t,e,n){t.state("root.search",{url:e.search,templateUrl:n+"search/search.tmpl.html",controllerAs:"search",controller:"SearchCtrl",resolve:{}})}]).controller("SearchCtrl",["searchMovies","PaginatedMovies",function(t,e){var n=this;n.searchResults=e.get(),n.searchTotal=e.total,n.pagination=e.pagination,n.entity={keyword:"Jaws"},n.submitSearch=function(){return t(n.entity.keyword,{page:2})}}]),angular.module("routes").config(["$stateProvider","URLMAP","ROUTESURL",function(t,e,n){t.state("root.home",{url:e.home,templateUrl:n+"home/home.tmpl.html",controller:"HomeCtrl",publicRoute:!0,resolve:{thing:function(){console.log("home resolv")}}})}]).controller("HomeCtrl",function(){}),angular.module("navbar",["core","mgcrea.ngStrap","ui.router"]).constant("NAVBARURL","app/modules/navbar/").directive("navigationBar",["NAVBARURL",function(t){return{scope:{navigation:"="},templateUrl:t+"navbar.tmpl.html",controllerAs:"navbar",bindToController:!0,controller:function(){var t=this;t.brand=_.find(t.navigation,{brand:!0})||t.navigation[0]}}}]),angular.module("core",["ngCookies","ngTouch","ngAnimate","ngSanitize"]).constant("COREURL","app/core/").config(["iocMapProvider",function(t){t.map({userGateway:"lsUserGateway"})}]),angular.module("core").factory("User",["BaseEntity",function(t){var e=t.extend({constructor:function(){t.apply(this,arguments),this.set("isAdmin",!1)}});return new e}]),angular.module("core").provider("iocMap",["$provide",function(t){this.map=function(e){_.each(e,function(e,n){var a=function(t){return t};a.$inject=[e],t.factory(n,a)})},this.$get=[]}]),angular.module("core").factory("formBuilder",["$q",function(t){return function(e){return angular.extend({},{scope:{entity:"=entity",submitFn:"&submitFn"},transclude:!0,bindToController:!0,controllerAs:"form",controller:function(n){if(null==this.entity)throw new Error("Form requires entity");var a=this.original=angular.copy(this.entity);this.submit=function(){t.when(this.submitFn()(this.entity)).then(function(){n[e.formName].$setPristine(),n[e.formName].$setUntouched()})},n.$watchCollection("form.entity",function(t){return n[e.formName].$pristine?(null==t.id&&angular.extend(n.form.entity,e.defaults),!0):void angular.forEach(e.validators,function(o,r){n[e.formName].$setValidity(r,o(t,a))})}),this.modelOptions={updateOn:"default blur",debounce:{"default":200,blur:0}}}},e)}}]),angular.module("core").factory("extendPrototype",function(){return function(t,e){var n,a=this;n=t&&_.has(t,"constructor")?t.constructor:function(){return a.apply(this,arguments)},_.assign(n,a,e);var o=function(){this.constructor=n};return o.prototype=a.prototype,n.prototype=new o,t&&_.assign(n.prototype,t),n.__super__=a.prototype,n}}),angular.module("core").factory("BaseEntity",["extendPrototype",function(t){function e(){this.data={}}return e.prototype.set=function(t,e){"string"==typeof t?this.data[t]=e:(this.reset(),this.assign(this.data,t))},e.prototype.get=function(t){return null==t?this.data:this.data[t]},e.prototype.reset=function(){for(var t in this.data)delete this.data[t]},_.each(["assign","has","findKey","forIn","isEmpty","keys","clone","pick","mapValues"],function(t){e.prototype[t]=function(){var e=Array.prototype.slice.call(arguments,0);return _[t].apply(_,[this.data].concat(e))}}),e.extend=t,e}]),angular.module("core").factory("BaseCollection",["extendPrototype",function(t){function e(){this.list=[]}return e.prototype.get=function(t){return null!=t?this.find({id:t}):this.list},e.prototype.add=function(t){this.list.push(t)},e.prototype.set=function(t){this.reset(),angular.extend(this.list,t)},e.prototype.reset=function(){this.list.length=0},_.each(["where","find","filter","forEach","map","max","min","pluck","sortBy","reject","remove"],function(t){e.prototype[t]=function(){var e=Array.prototype.slice.call(arguments,0);return _[t].apply(_,[this.list].concat(e))}}),e.extend=t,e}]),angular.module("core").constant("SECRETPASSWORD","cheese").constant("USER_KEY","localStorageUser").factory("lsUserGateway",["$q","$localStorage","USER_KEY","SECRETPASSWORD",function(t,e,n,a){return{validCredentials:function(e){return t(function(t,n){e.password==a?t():n()})},saveToClient:function(a){return t(function(t){e[n]=a,t()})},getFromClient:function(){return t(function(t){t(e[n])})}}}]),angular.module("core").factory("fetchUserFromClient",["User","userGateway",function(t,e){return function(){return e.getFromClient().then(function(e){null!=e&&t.set(e)})}}]),angular.module("tfIntensiveRottentomsApp",["config","core","routes","navbar"]).run(["$rootScope","LOCAL_CONFIG","NAVIGATION","User",function(t,e,n,a){e&&console.info("Current Local Config:",e),t.user=a.get(),t.$watch("user.isAdmin",function(e){t.navigation=e?n.userNav:n.guestNav})}]),angular.module("tfIntensiveRottentomsApp").controller("NavbarCtrl",["$scope",function(t){t.date=new Date}]),angular.module("modules",["search","navbar","login"]),angular.module("config",[]).value("LOCAL_CONFIG",!1).constant("NAVIGATION",{guestNav:[{name:"signin",path:"root.signin",label:"Signup"}],userNav:[{name:"home",path:"root.home",label:"Home"},{name:"search",path:"root.search",label:"Search"}]}),angular.module("config").constant("LOCAL_CONFIG",{env:"DEV"}).config(function(){}).run(["User",function(){}]),angular.module("tfIntensiveRottentomsApp").run(["$templateCache",function(t){t.put("components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse" ng-controller="NavbarCtrl"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href="https://github.com/Swiip/generator-gulp-angular"><span class="glyphicon glyphicon-home"></span> Gulp Angular</a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-6"><ul class="nav navbar-nav"><li class="active"><a ng-href="#">Home</a></li><li><a ng-href="#">About</a></li><li><a ng-href="#">Contact</a></li></ul><ul class="nav navbar-nav navbar-right"><li>Current date: {{ date | date:\'yyyy-MM-dd\' }}</li></ul></div></div></nav>'),t.put("app/modules/navbar/navbar.tmpl.html",'<div class="navbar navbar-default" role="navigation" bs-navbar=""><div class="navbar-header"><a class="navbar-brand" ui-sref="{{::navbar.brand.path}}">Angular Intensive</a></div><ul class="nav navbar-nav"><li ng-repeat="nav in navbar.navigation" ui-sref-active="active"><a ui-sref="{{::nav.path}}">{{::nav.label}}</a></li></ul></div>'),t.put("app/routes/home/home.tmpl.html",'<div class="container"><div class="jumbotron text-center"><h1>\'Allo, \'Allo!</h1><p class="lead"><img src="assets/images/yeoman.png" alt="I\'m Yeoman"><br>Always a pleasure scaffolding your apps.</p><p><a class="btn btn-lg btn-success" ng-href="#">Splendid!</a></p></div></div>'),t.put("app/routes/search/search.tmpl.html",'<div class="container"><search-form entity="search.entity" submit-fn="search.submitSearch"></search-form><h3>Search</h3><pre>{{ search.searchTotal | json}}</pre><pre>{{ search.pagination | json}}</pre><pre>{{ search.searchResults | json}}</pre></div>'),t.put("app/routes/signin/signin.tmpl.html",'<div class="container"><h3>Sign in</h3><signin-form entity="signin.user" submit-fn="signin.submitLogin"></signin-form></div>'),t.put("app/modules/login/components/form.tmpl.html",'<form name="signinForm" ng-submit="form.submit(form.entity)" novalidate=""><fieldset class="form-group required"><label for="keyword" class="control-label">User Name:</label> <input type="text" class="form-control" ng-model="form.entity.username" name="username" id="username" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 200, \'blur\': 0 } }" required=""></fieldset><fieldset class="form-group required"><label for="Keyword" class="control-label">Password:</label> <input type="password" class="form-control" ng-model="form.entity.password" name="password" id="password" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 200, \'blur\': 0 } }" required=""></fieldset><div class="controls"><button ng-disabled="signinForm.$invalid" type="submit" class="btn btn-success">Save</button></div></form>'),t.put("app/modules/search/components/form.tmpl.html",'<form name="searchForm" ng-submit="form.submit()" novalidate=""><fieldset class="form-group required"><label for="keyword" class="control-label">Search:</label> <input type="text" class="form-control" ng-model="form.entity.keyword" name="keyword" id="keyword" ng-model-options="{ updateOn: \'default blur\', debounce: { \'default\': 200, \'blur\': 0 } }" required=""></fieldset></form>')}]);